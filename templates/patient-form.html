<form name="patientForm" ng-submit="validateForm(patientForm.$valid) && save()" novalidate>
  <fieldset ng-disabled="posting">
    <h3>Info om bruker</h3>

    <label>Fornavn</label>

    <div class="row">
      <div class="col-md-3">
        <input type="text" ng-model="patient.user.first_name" class="form-control" required>
      </div>
    </div>

    <label>Etternavn</label>

    <div class="row">
      <div class="col-md-3">
        <input type="text" ng-model="patient.user.last_name" class="form-control" required>
      </div>
    </div>

    <label>Fødselsnummer</label>

    <div class="row">
      <div class="col-md-3">
        <input type="text" ng-model="patient.national_identification_number" class="form-control" required ng-minlength="11" ng-maxlength="11">
      </div>
    </div>

    <label>Telefonnummer</label>

    <div class="row">
      <div class="col-md-3">
        <input type="text" ng-model="patient.phone_number" class="form-control">
      </div>
    </div>

    <label>Adresse</label>

    <div class="row">
      <div class="col-md-3">
        <input type="text" ng-model="patient.address" class="form-control">
      </div>
    </div>

    <label>Postnummer</label>

    <div class="row">
      <div class="col-md-3">
        <input type="text" ng-model="patient.zip_code" class="form-control" ng-minlength="4" ng-maxlength="4">
      </div>
    </div>

    <label>Poststed</label>

    <div class="row">
      <div class="col-md-3">
        <input type="text" ng-model="patient.city" class="form-control">
      </div>
    </div>


    <h3>Normalverdier</h3>

    <p>Det generes varsler hvis verdiene går utenfor disse grenseverdiene</p>

    <div class="row">
      <div class="col-md-3">
        <h4>O2-metning</h4>
      </div>
      <div class="col-md-3">
        <label class="control-label">Min (%)</label>
        <input type="number" ng-model="patient.o2_min" class="form-control">
      </div>
      <div class="col-md-3">
        <label class="control-label">Maks (%)</label>
        <input type="number" ng-model="patient.o2_max" class="form-control">
      </div>
    </div>
    <div class="row">
      <div class="col-md-3">
        <h4>Puls</h4>
      </div>
      <div class="col-md-3">
        <label class="control-label">Min (slag/min.)</label>
        <input type="number" ng-model="patient.pulse_min" class="form-control">
      </div>
      <div class="col-md-3">
        <label class="control-label">Maks (slag/min.)</label>
        <input type="number" ng-model="patient.pulse_max" class="form-control">
      </div>
    </div>
    <div class="row">
      <div class="col-md-3">
        <h4>Temperatur</h4>
      </div>
      <div class="col-md-3">
        <label class="control-label">Min (°C)</label>
        <input type="number" ng-model="patient.temperature_min" class="form-control">
      </div>
      <div class="col-md-3">
        <label class="control-label">Maks (°C)</label>
        <input type="number" ng-model="patient.temperature_max" class="form-control">
      </div>
    </div>

    <h3>Synlig for bruker</h3>

    <div class="checkbox">
      <label><input type="checkbox" ng-model="patient.activity_access">Aktivitetsmålinger</label>
    </div>
    <div class="checkbox">
      <label><input type="checkbox" ng-model="patient.o2_access">O2-metning</label>
    </div>
    <div class="checkbox">
      <label><input type="checkbox" ng-model="patient.pulse_access">Puls</label>
    </div>
    <div class="checkbox">
      <label><input type="checkbox" ng-model="patient.temperature_access">Temperatur</label>
    </div>

    <h3>Motiverende tekster</h3>

    <div ng-repeat="motivationalText in patient.motivation_texts">
      <div class="row marginBottom20">
        <div class="col-md-9">
          <textarea ng-model="motivationalText.text" class="form-control" rows="2"/>
        </div>
        <div class="col-md-3">
          <button ng-click="removeMotivationalText($index)" class="btn btn-danger btn-sm">
            <span class="glyphicon glyphicon-remove"></span> Fjern
          </button>
        </div>
      </div>
    </div>
    <button ng-click="addMotivationalText()" class="btn btn-success">
      <span class="glyphicon glyphicon-plus"></span> Legg til ny motiverende tekst
    </button>

    <h3>Informative meldinger til bruker (API ikke klart ennå)</h3>
    <!--<div ng-repeat="infoText in patient.info_texts">
      <div class="row marginBottom20">
        <div class="col-md-9">
          <textarea ng-model="infoText.text" class="form-control"/>
        </div>
        <div class="col-md-3">
          <button ng-click="removeInfoText($index)" class="btn btn-danger btn-sm">
            <span class="glyphicon glyphicon-remove"></span> Fjern
          </button>
        </div>
      </div>
    </div>
    <button ng-click="addInfoText()" class="btn btn-success">
      <span class="glyphicon glyphicon-plus"></span> Legg til ny informativ tekst
    </button>-->

    <h3>Pårørende</h3>

    <div class="panel panel-default panel-body" ng-repeat="contact in patient.next_of_kin">
      <h4 ng-show="$index === 0"><span class="glyphicon glyphicon-star"></span> Hovedpårørende</h4>
      <h4 ng-hide="$index === 0">{{ $index + 1 }}. pårørende</h4>

      <div class="form-group">
        <label>
          Navn
          <input type="text" ng-model="contact.full_name" class="form-control" required>
        </label>
      </div>
      <div class="form-group">
        <label>
          Telefon
          <input type="text" ng-model="contact.phone_number" class="form-control">
        </label>
      </div>
      <div class="form-group">
        <label>
          Adresse
          <input type="text" ng-model="contact.address" class="form-control">
        </label>
      </div>
      <div class="form-group">
        <label>
          Rolle
          <input type="text" ng-model="contact.relation" class="form-control">
        </label>
      </div>

      <button ng-click="removeNextOfKin($index)" class="btn btn-danger">
        <span class="glyphicon glyphicon-remove"></span> Fjern
      </button>
      <div class="btn-group">
        <button ng-click="moveNextOfKinUp($index)" class="btn btn-default" ng-if="!$first">
          <span class="glyphicon glyphicon-chevron-up"></span> Flytt opp
        </button>
        <button ng-click="moveNextOfKinDown($index)" class="btn btn-default" ng-if="!$last">
          <span class="glyphicon glyphicon-chevron-down"></span> Flytt ned
        </button>
      </div>
    </div>
    <button ng-click="addNextOfKin()" class="btn btn-success">
      <span class="glyphicon glyphicon-plus"></span> Legg til pårørende
    </button>

    <br>
    <br>
    <alert ng-repeat="alert in alerts" type="{{alert.type}}" close="closeAlert($index)">{{alert.msg}} </alert>
    <button id="bottom" class="btn btn-primary btn-lg" type="submit">
      <span class="glyphicon glyphicon-ok"></span> Lagre
    </button>
    <span class="medium-padding" ng-show="posting">
      <img src="lib/graphics/spinner.gif" alt="Laster..." style="width:20px;height:20px">
    </span>
  </fieldset>
</form>
